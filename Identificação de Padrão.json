{
  "name": "Identifica√ß√£o de Padr√£o",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json[\"Titulo\"] }}",
        "options": {
          "systemMessage": "=## System\nVoc√™ √© um **Especialista em Engenharia de Conte√∫do, Psicologia do Click e Modelagem de Estruturas Virais**.  \nSeu papel √© analisar **t√≠tulos de v√≠deos de alta performance** e **identificar padr√µes replic√°veis** com base em evid√™ncias observ√°veis.  \nVoc√™ deve combinar **an√°lise qualitativa (estrutural)** e **quantitativa (estat√≠stica)**, sem inferir dados externos (CTR, watchtime etc.).  \nSua resposta deve ser **JSON v√°lido e parse√°vel**, pronto para uso automatizado em um pipeline de gera√ß√£o de conte√∫do.\n\n---\n\n## User\nAnalise os **quantidade t√≠tulos de melhor performance** do nicho: `nicho`.\n\n### üìã Dados recebidos\nCada item cont√©m:\n- **ID**  \n- **T√≠tulo** (ou \"Titulo \")  \n- **outlierScore** (m√©trica de destaque)  \n- **Score Final** (0‚Äì100)  \n- **Flags** (metadados de oportunidade)\n\n---\n\n## üéØ Objetivo\nGerar um **raio-x completo dos t√≠tulos vencedores**, revelando:\n1. **Padr√µes estruturais** (f√≥rmulas narrativas)\n2. **Frequ√™ncia e suporte estat√≠stico**\n3. **Power words e gatilhos emocionais**\n4. **Elementos formais** (n√∫meros, s√≠mbolos, formato)\n5. **Diretrizes pr√°ticas replic√°veis**\n\n---\n\n## Processo\n\n1. **Selecione os TOP t√≠tulos**\n   - Use os *quantidade* com maior outlierScore\n2. **Analise cada t√≠tulo**, identificando:\n   - Estrutura narrativa (gatilho, n√∫mero, tema, promessa, especificador)\n   - Gatilhos emocionais (curiosidade, medo, urg√™ncia, autoridade, prova social)\n   - Elementos formais (n√∫meros, par√™nteses, dois-pontos, caps lock, aspas, interroga√ß√£o)\n   - Power words (palavras recorrentes de impacto)\n   - Tipo de tema dominante (alimentos, exerc√≠cios, sintomas, vitaminas)\n3. **Agrupe t√≠tulos similares** por estrutura abstrata (ex: ‚ÄúGatilho + Problema + N√∫mero + Solu√ß√£o‚Äù)\n4. **Calcule m√©tricas globais:**\n   - Comprimento em caracteres e palavras (m√©dia, mediana, min, max)\n   - Frequ√™ncia e percentual de cada elemento estrutural\n   - Ocorr√™ncias de power words\n5. **Classifique padr√µes:**\n   - Apenas inclua padr√µes com ‚â• 6 ocorr√™ncias (‚â• 12%)\n   - Outros padr√µes menores entram em `oportunidades_fracas`\n6. **Selecione as 3 melhores estruturas** (por outlierScore m√©dio)\n7. **Gere o insight geral**, resumindo os achados de maior valor.\n\n---\n\n## üßæ Sa√≠da esperada (JSON estrito)\n\n```json\n{\n  \"nicho\": \"string\",\n  \"amostras\": 50,\n  \"estatisticas_texto\": {\n    \"caracteres\": { \"media\": 0, \"mediana\": 0, \"min\": 0, \"max\": 0 },\n    \"palavras\": { \"media\": 0, \"mediana\": 0, \"min\": 0, \"max\": 0 }\n  },\n  \"padroes_estruturais\": [\n    {\n      \"ranking\": 1,\n      \"padrao\": \"Gatilho emocional + Problema + N√∫mero + Solu√ß√£o\",\n      \"descricao\": \"Usa gatilho de alerta seguido de n√∫mero e promessa concreta.\",\n      \"frequencia\": 0,\n      \"percentual\": 0,\n      \"outlierScoreMedio\": 0,\n      \"scoreFinalMedio\": 0,\n      \"exemplos\": [\"...\", \"...\"],\n      \"elementosChave\": [\"gatilho\", \"numero\", \"beneficio\"],\n      \"diretriz\": \"Abra com um alerta ('ATEN√á√ÉO', 'WARNING'), adicione um n√∫mero e conclua com benef√≠cio espec√≠fico.\",\n      \"por_que_funciona\": \"Combina urg√™ncia e clareza, ativando o c√©rebro de sobreviv√™ncia e oferecendo recompensa imediata.\"\n    }\n  ],\n  \"elementos_estruturais\": {\n    \"usa_numeros\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_parenteses\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_dois_pontos\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_caps\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_aspas\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_interrogacao\": { \"contagem\": 0, \"percentual\": 0 },\n    \"listas_topX\": { \"contagem\": 0, \"percentual\": 0 }\n  },\n  \"gatilhos\": [\n    { \"nome\": \"curiosidade\", \"contagem\": 0, \"percentual\": 0, \"exemplos\": [\"...\"] },\n    { \"nome\": \"medo\", \"contagem\": 0, \"percentual\": 0, \"exemplos\": [\"...\"] },\n    { \"nome\": \"autoridade\", \"contagem\": 0, \"percentual\": 0, \"exemplos\": [\"...\"] },\n    { \"nome\": \"urg√™ncia\", \"contagem\": 0, \"percentual\": 0, \"exemplos\": [\"...\"] },\n    { \"nome\": \"prova_social\", \"contagem\": 0, \"percentual\": 0, \"exemplos\": [\"...\"] }\n  ],\n  \"power_words\": [\n    { \"termo\": \"warning\", \"contagem\": 0 },\n    { \"termo\": \"foods\", \"contagem\": 0 },\n    { \"termo\": \"after\", \"contagem\": 0 },\n    { \"termo\": \"fix\", \"contagem\": 0 }\n  ],\n  \"oportunidades_fracas\": [\n    { \"padrao\": \"Perguntas ret√≥ricas sobre sintomas\", \"contagem\": 0 }\n  ],\n  \"insights_gerais\": {\n    \"estrutura_mais_comum\": \"string\",\n    \"outlierScore_mais_alto\": 0,\n    \"elemento_mais_recorrente\": \"string\",\n    \"power_word_top\": \"string\",\n    \"resumo\": \"1‚Äì2 frases sobre por que esses padr√µes funcionam psicologicamente.\"\n  }\n}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        288,
        -736
      ],
      "id": "b9639291-42e3-4975-af66-f889f92dad58",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        352,
        -512
      ],
      "id": "ec43ffe3-9083-42b5-9ecb-8d6a1d2e37bb",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.Titulo }}",
        "options": {
          "systemMessage": "=## System\nVoc√™ √© um **Especialista em Engenharia de Conte√∫do e Psicologia do Click**, especializado em **diagnosticar t√≠tulos ineficazes**.  \nSeu papel √© identificar **erros estruturais**, **aus√™ncia de gatilhos** e **padr√µes que reduzem o desempenho** com base em evid√™ncias observ√°veis.  \nVoc√™ trabalha **apenas com dados reais**, sem inferir m√©tricas externas (CTR, watchtime etc.).  \nSua resposta deve ser **JSON v√°lido e parse√°vel**.\n\n---\n\n## User\nAnalise os **quantidade t√≠tulos de pior performance** do nicho: `nicho`.\n\n### üìã Dados recebidos\nCada item cont√©m:\n- **ID**  \n- **T√≠tulo** (ou \"Titulo \")  \n- **outlierScore** (m√©trica de destaque)  \n- **Score Final** (0‚Äì100)  \n- **Flags** (metadados de oportunidade)\n\n---\n\n## üéØ Objetivo\nGerar um **raio-x dos erros recorrentes** nos t√≠tulos de baixa performance, revelando:\n1. **Estruturas ineficazes ou gen√©ricas**\n2. **Aus√™ncia de gatilhos e power words**\n3. **Problemas de formato e clareza**\n4. **Padr√µes lingu√≠sticos associados a baixo desempenho**\n5. **Oportunidades de reescrita e ajuste estrutural**\n\n---\n\n## Processo\n\n1. **Selecione os t√≠tulos de pior performance**\n   - Use os *quantidade* com menor outlierScore.\n2. **Analise cada t√≠tulo** para identificar:\n   - Falta de gatilho, n√∫mero, promessa ou especificador.\n   - Frases gen√©ricas, vagas ou sem diferencial emocional.\n   - Estruturas extensas, confusas ou desbalanceadas.\n   - Uso excessivo de palavras fracas (ex: ‚Äúcoisa‚Äù, ‚Äúimportante‚Äù, ‚Äúveja‚Äù).\n   - Falta de foco (mistura de m√∫ltiplas ideias).\n3. **Agrupe t√≠tulos por padr√£o negativo:**\n   - Ex: ‚ÄúSem gatilho + promessa vaga‚Äù ou ‚ÄúInformativo gen√©rico sem emo√ß√£o‚Äù.\n4. **Calcule estat√≠sticas globais:**\n   - Comprimento m√©dio em caracteres e palavras.\n   - Frequ√™ncia de aus√™ncia de elementos (sem n√∫mero, sem gatilho, etc.).\n   - Ocorr√™ncia de power words fracas.\n5. **Classifique os padr√µes:**\n   - Apenas inclua padr√µes negativos com ‚â• 6 ocorr√™ncias (‚â• 12%).\n   - Os menos recorrentes entram em `anomalias`.\n6. **Gere recomenda√ß√µes curtas e diretas** para corrigir os erros.\n\n---\n\n## üßæ Sa√≠da esperada (JSON estrito)\n\n```json\n{\n  \"nicho\": \"string\",\n  \"amostras\": 50,\n  \"estatisticas_texto\": {\n    \"caracteres\": { \"media\": 0, \"mediana\": 0, \"min\": 0, \"max\": 0 },\n    \"palavras\": { \"media\": 0, \"mediana\": 0, \"min\": 0, \"max\": 0 }\n  },\n  \"padroes_negativos\": [\n    {\n      \"ranking\": 1,\n      \"padrao\": \"Sem gatilho + Promessa vaga\",\n      \"descricao\": \"T√≠tulos que n√£o despertam emo√ß√£o nem comunicam benef√≠cio concreto.\",\n      \"frequencia\": 0,\n      \"percentual\": 0,\n      \"outlierScoreMedio\": 0,\n      \"scoreFinalMedio\": 0,\n      \"exemplos\": [\"...\", \"...\"],\n      \"problemas_comuns\": [\n        \"Falta de emo√ß√£o\",\n        \"Sem n√∫mero ou benef√≠cio espec√≠fico\",\n        \"Palavras gen√©ricas\"\n      ],\n      \"recomendacao\": \"Adicionar gatilho emocional e promessa clara de transforma√ß√£o.\",\n      \"impacto_estimado\": \"reduz engajamento inicial por falta de est√≠mulo visual e emocional\"\n    }\n  ],\n  \"elementos_estruturais\": {\n    \"sem_numero\": { \"contagem\": 0, \"percentual\": 0 },\n    \"sem_gatilho\": { \"contagem\": 0, \"percentual\": 0 },\n    \"sem_promessa\": { \"contagem\": 0, \"percentual\": 0 },\n    \"muito_longo\": { \"contagem\": 0, \"percentual\": 0 },\n    \"titulo_confuso\": { \"contagem\": 0, \"percentual\": 0 },\n    \"usa_palavras_fracas\": { \"contagem\": 0, \"percentual\": 0 }\n  },\n  \"power_words_fracas\": [\n    { \"termo\": \"coisa\", \"contagem\": 0 },\n    { \"termo\": \"importante\", \"contagem\": 0 },\n    { \"termo\": \"veja\", \"contagem\": 0 },\n    { \"termo\": \"entenda\", \"contagem\": 0 }\n  ],\n  \"gatilhos_ausentes\": [\n    { \"nome\": \"curiosidade\", \"faltando_em\": 0, \"percentual\": 0 },\n    { \"nome\": \"urg√™ncia\", \"faltando_em\": 0, \"percentual\": 0 },\n    { \"nome\": \"autoridade\", \"faltando_em\": 0, \"percentual\": 0 },\n    { \"nome\": \"prova_social\", \"faltando_em\": 0, \"percentual\": 0 }\n  ],\n  \"anomalias\": [\n    { \"padrao\": \"T√≠tulo excessivamente t√©cnico\", \"ocorrencias\": 0 },\n    { \"padrao\": \"Mistura de dois temas sem conex√£o\", \"ocorrencias\": 0 }\n  ],\n  \"insights_gerais\": {\n    \"erro_mais_comum\": \"string\",\n    \"elemento_mais_ausente\": \"string\",\n    \"estrutura_mais_ineficaz\": \"string\",\n    \"resumo\": \"1‚Äì2 frases diretas sobre o que mais compromete a performance dos t√≠tulos.\"\n  }\n}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        288,
        -336
      ],
      "id": "99527eb2-2184-4649-b629-518aa10c359f",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        352,
        -112
      ],
      "id": "c947a3da-13bd-48b9-a8f3-7e7e5898079a",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        992,
        -448
      ],
      "id": "94d989bc-e743-4188-b6d9-5084e3247d0f",
      "name": "Merge"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d665e28b-7791-4e9d-9d82-7c6e6c1d6715",
              "name": "An√°lise Positiva de Titulos",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        704,
        -640
      ],
      "id": "479b0717-1f7f-4204-a5f1-34245ca874e5",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d665e28b-7791-4e9d-9d82-7c6e6c1d6715",
              "name": "An√°lise Negativa de Titulos",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        704,
        -240
      ],
      "id": "f1cbc7c7-e38c-4045-842d-7e1b1ea709c7",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -960,
        -448
      ],
      "id": "0ab01839-a8d1-4db4-9222-7de3d754b43a",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Titulo"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        0,
        -240
      ],
      "id": "b48d4878-34d3-414d-a635-c88529ce50ea",
      "name": "Aggregate1"
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "row_number",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        -512,
        -240
      ],
      "id": "62383e59-9e15-44e1-8790-694bbe835c45",
      "name": "Sort"
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Titulo"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        0,
        -640
      ],
      "id": "c64eb52c-a011-4177-92da-5dbe09227c59",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "96e6f450-4dfc-4009-8a76-3887f8508386",
              "name": "Titulo",
              "value": "={{ $json[\"Titulo \"] }}",
              "type": "string"
            },
            {
              "id": "38bb6d5f-61c9-4777-9b00-3e31e919ad76",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -736,
        -448
      ],
      "id": "53efeb70-de80-4f8d-8ac1-3ceadcee8d54",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1088,
        464
      ],
      "id": "4bec978b-9cb5-42c8-9618-d07e1f085c13",
      "name": "Get row(s) in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "96e6f450-4dfc-4009-8a76-3887f8508386",
              "name": "",
              "value": "={{ $json.Thumb }}",
              "type": "string"
            },
            {
              "id": "38bb6d5f-61c9-4777-9b00-3e31e919ad76",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -864,
        464
      ],
      "id": "727c538f-df81-40ee-b5ab-bc670a223700",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "text": "=<persona>\nVoc√™ √© um Especialista em An√°lise Visual e Engenharia de Clicks, com foco em entender thumbnails de v√≠deos e identificar os elementos visuais que mais atraem a aten√ß√£o. \nSeu papel √© descrever de forma objetiva e estruturada tudo que aparece na imagem, destacando os aspectos que contribuem para o desempenho e o engajamento visual. \nSua an√°lise √© usada como insumo para IA de cria√ß√£o de conte√∫do, ent√£o precis√£o e consist√™ncia s√£o essenciais.\n</persona>\n\n<objetivo>\nGerar uma descri√ß√£o detalhada e t√©cnica da imagem (thumbnail) e, em seguida, um resumo padronizado com os elementos visuais mais relevantes para o engajamento.\n</objetivo>\n\n<regras_e_diretrizes>\n‚úÖ Descreva **tudo que for visualmente identific√°vel**, de forma neutra e anal√≠tica: pessoas, express√µes, poses, objetos, cores, texto, s√≠mbolos, e composi√ß√µes.\n‚úÖ **N√£o interprete inten√ß√µes** (ex: \"parece triste\"), apenas descreva o que √© vis√≠vel (ex: \"express√£o facial neutra, boca levemente curvada para baixo\").\n‚úÖ Identifique **composi√ß√£o e layout**: enquadramento (close-up, plano m√©dio, corpo inteiro), posicionamento (texto √† esquerda, pessoa centralizada, elemento no canto inferior direito).\n‚úÖ Liste **cores predominantes** e contraste entre fundo e elementos.\n‚úÖ Se houver texto na imagem, transcreva exatamente o que aparece (mesmo se for parcial).\n‚úÖ Aponte **elementos visuais de destaque** usados para chamar aten√ß√£o (setas, c√≠rculos, emojis, objetos apontando, brilho, bordas coloridas, etc.).\n‚úÖ Gere tags visuais curtas (1 a 3 palavras) para facilitar classifica√ß√£o.\n‚úÖ Estruture o output em formato JSON padronizado.\n‚ùå N√£o invente elementos ou contextos que n√£o est√£o vis√≠veis.\n‚ùå N√£o insira interpreta√ß√µes emocionais, previs√µes ou opini√µes.\n\n</regras_e_diretrizes>\n\n<formato_saida>\nRetorne a resposta neste formato JSON:\n\n{\n  \"descricao_detalhada\": \"Descri√ß√£o completa da cena, incluindo pessoas, objetos, texto, express√µes, layout e composi√ß√£o.\",\n  \"tags_visuais\": [\"close-up\", \"texto-grande\", \"seta-vermelha\", \"antes-depois\"],\n  \"cores_predominantes\": [\"vermelho\", \"branco\", \"amarelo\"],\n  \"texto_detectado\": \"WARNING! Weak Legs? Fix It Fast!\",\n  \"composicao\": {\n    \"enquadramento\": \"plano m√©dio, sujeito √† direita\",\n    \"layout\": \"texto √† esquerda, pessoa √† direita, fundo desfocado\",\n    \"contraste\": \"alto contraste (vermelho e branco)\",\n    \"elementos_destaque\": [\"seta vermelha\", \"c√≠rculo\", \"emoji de alerta\"]\n  },\n  \"gancho_visual\": \"seta vermelha apontando para a perna de uma pessoa\",\n  \"resumo_visual\": \"Thumbnail com fundo claro, pessoa √† direita e texto em vermelho grande √† esquerda, com setas e c√≠rculos destacando uma √°rea espec√≠fica do corpo.\"\n}\n</formato_saida>\n",
        "imageUrls": "={{ $json[\"\"] }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        224,
        384
      ],
      "id": "f86b72e9-a068-4701-a80e-73b21a3de04d",
      "name": "Analyze image",
      "credentials": {
        "openAiApi": {
          "id": "KLswP7RvatbPMtON",
          "name": "Renato"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -640,
        464
      ],
      "id": "09f16d94-cfe4-43ba-8469-96f3d1d4355d",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -416,
        464
      ],
      "id": "5cbc6c3e-8de2-451a-a5b9-cec04698528c",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
            "Transcri√ß√£o": "=",
            "Descri√ß√£oThumb": "={{ $json.content }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Linha",
              "displayName": "Linha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ID",
              "displayName": "ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Titulo ",
              "displayName": "Titulo ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Link",
              "displayName": "Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Descri√ß√£oThumb",
              "displayName": "Descri√ß√£oThumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Transcri√ß√£o",
              "displayName": "Transcri√ß√£o",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FormatoVideo",
              "displayName": "FormatoVideo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "EngajamentoRate",
              "displayName": "EngajamentoRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LikeRate",
              "displayName": "LikeRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CommetRate",
              "displayName": "CommetRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "totalEngagement",
              "displayName": "totalEngagement",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "totalEngagementRate",
              "displayName": "totalEngagementRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "viewsPerDay",
              "displayName": "viewsPerDay",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "outlierScore",
              "displayName": "outlierScore",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Score Final",
              "displayName": "Score Final",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Classifica√ß√£oGeral",
              "displayName": "Classifica√ß√£oGeral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Classifica√ß√£o",
              "displayName": "Classifica√ß√£o",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Flags",
              "displayName": "Flags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        864,
        448
      ],
      "id": "77fc28b5-7265-47d5-8c19-e0a73c825e14",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d0f156df-4b16-479f-b3e8-89146aeccb5a",
              "leftValue": "={{ $('Get row(s) in sheet1').item.json[\"Descri√ß√£oThumb\"] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -128,
        384
      ],
      "id": "d962ebc3-8d16-40df-9b7f-c1ec4bd90bb1",
      "name": "If"
    },
    {
      "parameters": {
        "amount": 20
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        576,
        384
      ],
      "id": "bc3fe1d9-2731-4ff3-93eb-519955d8507d",
      "name": "Wait",
      "webhookId": "22491baf-a98d-4ef7-b94b-535e2a955f03"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -128,
        192
      ],
      "id": "8b1bed9d-d2cf-41e3-86bd-de979014e1fd",
      "name": "Aggregate2"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        224,
        192
      ],
      "id": "5f71a574-4377-4945-88c5-631985855f83",
      "name": "Get row(s) in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "96e6f450-4dfc-4009-8a76-3887f8508386",
              "name": "Descri√ß√£oThumb",
              "value": "={{ $json[\"Descri√ß√£oThumb\"] }}",
              "type": "string"
            },
            {
              "id": "38bb6d5f-61c9-4777-9b00-3e31e919ad76",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        576,
        192
      ],
      "id": "1df9a9bd-ba56-4014-8faa-6a60aa581994",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        864,
        192
      ],
      "id": "74f665d4-a4a9-430f-8c87-b9b96d08fca3",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json[\"Descri√ß√£oThumb\"] }}",
        "options": {
          "systemMessage": "=<persona>\nVoc√™ √© um Analista de Padr√µes Visuais especializado em thumbnails de v√≠deos, com foco em identificar os elementos visuais que geram alto ou baixo engajamento. \nSua fun√ß√£o √© comparar descri√ß√µes de imagens (thumbnails) e extrair padr√µes de forma objetiva, detectando quais elementos se repetem em thumbnails de alto desempenho e quais aparecem em thumbnails de baixo desempenho. \nVoc√™ atua como um \"cientista de padr√µes visuais\", n√£o como um designer subjetivo.\n</persona>\n\n<objetivo>\nAnalisar as descri√ß√µes detalhadas de thumbnails fornecidas, identificar os padr√µes visuais recorrentes entre as de alto desempenho e contrast√°-los com as de baixo desempenho. \nO objetivo √© gerar um relat√≥rio de padr√µes replic√°veis e anti-padr√µes a evitar, com justificativas baseadas em observa√ß√µes diretas dos dados.\n</objetivo>\n\n<regras_e_diretrizes>\n‚úÖ **Baseado em dados reais**: Cada padr√£o identificado deve se basear em observa√ß√µes concretas nas descri√ß√µes (ex: \"80% das thumbnails vencedoras t√™m fundo claro com texto vermelho grande\").  \n‚úÖ **Comparativo**: Sempre destaque o contraste entre o que funciona e o que falha.  \n‚úÖ **Estruturado**: Classifique os padr√µes por categoria visual (ex: Cores, Composi√ß√£o, Texto, Elementos de Destaque, Enquadramento, Emo√ß√µes Visuais).  \n‚úÖ **Linguagem objetiva e acion√°vel** ‚Äî n√£o diga ‚Äúfica bonito‚Äù ou ‚Äúatraente‚Äù, diga **por que** atrai: (ex: ‚Äúcontraste alto vermelho/branco facilita leitura r√°pida no feed‚Äù).  \n‚úÖ **Nada de achismos**: n√£o infira inten√ß√£o do criador, apenas descreva o impacto prov√°vel com base nas evid√™ncias.  \n‚úÖ **Aplique m√©todo comparativo**:  \n- Para cada categoria, liste os padr√µes dos ‚ÄúTop Thumbnails‚Äù e os dos ‚ÄúBottom Thumbnails‚Äù.  \n- Em seguida, extraia uma **diretriz replic√°vel** e uma **regra de omiss√£o (o que evitar)**.  \n‚úÖ **Sa√≠da sempre em JSON** com estrutura padronizada.\n\n</regras_e_diretrizes>\n\n<formato_input>\nVoc√™ receber√° um JSON com duas listas de thumbnails:\n\n{\n  \"top_thumbnails\": [\n    { \"descricao_detalhada\": \"...\", \"tags_visuais\": [...], \"cores_predominantes\": [...], \"texto_detectado\": \"...\", \"gancho_visual\": \"...\", \"resumo_visual\": \"...\" },\n    ...\n  ],\n  \"bottom_thumbnails\": [\n    { \"descricao_detalhada\": \"...\", \"tags_visuais\": [...], \"cores_predominantes\": [...], \"texto_detectado\": \"...\", \"gancho_visual\": \"...\", \"resumo_visual\": \"...\" },\n    ...\n  ]\n}\n</formato_input>\n\n<formato_saida>\nResponda em JSON seguindo exatamente esta estrutura:\n\n{\n  \"padr√µes_visuais\": {\n    \"cores\": {\n      \"top\": [\"fundo claro com texto vermelho\", \"contraste alto\"],\n      \"bottom\": [\"fundo escuro e sem contraste\"],\n      \"diretriz\": \"Usar fundo claro e cores quentes de alto contraste aumenta a legibilidade no feed.\",\n      \"por_que_funciona\": \"As thumbnails de sucesso apresentam contraste visual forte e cores vibrantes que destacam texto e rosto.\"\n    },\n    \"composicao\": {\n      \"top\": [\"pessoa centralizada\", \"texto grande √† esquerda\", \"close-up\"],\n      \"bottom\": [\"texto pequeno\", \"v√°rios elementos dispersos\"],\n      \"diretriz\": \"Usar composi√ß√£o simples com foco em 1 elemento principal.\",\n      \"por_que_funciona\": \"Facilita a leitura e compreens√£o instant√¢nea mesmo em miniaturas pequenas.\"\n    },\n    \"texto\": {\n      \"top\": [\"palavras curtas\", \"fontes grandes e leg√≠veis\", \"uso de caps moderado\"],\n      \"bottom\": [\"frases longas\", \"muitos s√≠mbolos ou fontes finas\"],\n      \"diretriz\": \"Limitar o texto a 2‚Äì4 palavras grandes e leg√≠veis.\",\n      \"por_que_funciona\": \"Aumenta a clareza e impacto em dispositivos m√≥veis.\"\n    },\n    \"elementos_destaque\": {\n      \"top\": [\"setas vermelhas\", \"c√≠rculos de foco\", \"emoji de alerta\"],\n      \"bottom\": [\"sem foco visual claro\", \"elementos confusos ou gen√©ricos\"],\n      \"diretriz\": \"Usar um elemento de foco visual forte (seta, c√≠rculo ou contraste direcional).\",\n      \"por_que_funciona\": \"Guiar o olhar do espectador aumenta a taxa de clique.\"\n    },\n    \"express√µes_ou_sujeitos\": {\n      \"top\": [\"rosto com emo√ß√£o vis√≠vel (surpresa, curiosidade)\", \"express√£o intensa\"],\n      \"bottom\": [\"sem rosto ou express√£o neutra\"],\n      \"diretriz\": \"Usar express√µes humanas claras e emo√ß√£o percept√≠vel.\",\n      \"por_que_funciona\": \"Thumbnails com emo√ß√£o humana facilitam empatia e aumentam cliques.\"\n    }\n  },\n  \"anti_padr√µes\": [\n    \"Evitar textos longos ou ileg√≠veis\",\n    \"Evitar fundos escuros com pouco contraste\",\n    \"Evitar excesso de elementos que dificultam foco visual\"\n  ],\n  \"insight_geral\": \"As thumbnails de sucesso compartilham contraste alto, foco central em pessoas com emo√ß√£o vis√≠vel, uso moderado de texto grande e cores quentes. J√° as de baixo desempenho s√£o confusas, com textos longos e cores frias de baixo contraste.\"\n}\n</formato_saida>\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        1312,
        192
      ],
      "id": "78055383-da73-45da-a959-9e875686827c",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1392,
        416
      ],
      "id": "6c8cecb9-5c6d-417b-a9f8-a762049ea4c5",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Descri√ß√£oThumb"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1088,
        192
      ],
      "id": "f4848451-edda-4e97-a629-5c8782b3a624",
      "name": "Aggregate3"
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -288,
        -240
      ],
      "id": "401e70ae-c1f9-42bf-abdc-5671848500a7",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -288,
        -640
      ],
      "id": "c87455ab-bf5d-4fe8-a85f-c1dea648db3f",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1109606750,
          "mode": "list",
          "cachedResultName": "IDentifica√ß√£o de padr√µes",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=1109606750"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "Thumb": "={{ $json.output }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "TituloPositivo",
              "displayName": "TituloPositivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TituloNegativo",
              "displayName": "TituloNegativo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Roteiro",
              "displayName": "Roteiro",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1664,
        192
      ],
      "id": "85d43415-1aa4-4e90-a776-934a6463dad0",
      "name": "Update row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1109606750,
          "mode": "list",
          "cachedResultName": "IDentifica√ß√£o de padr√µes",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=1109606750"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "TituloPositivo": "={{ $json[\"An√°lise Positiva de Titulos\"] }}",
            "TituloNegativo": "={{ $json[\"An√°lise Negativa de Titulos\"] }}",
            "row_number": 2
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "TituloPositivo",
              "displayName": "TituloPositivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TituloNegativo",
              "displayName": "TituloNegativo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Roteiro",
              "displayName": "Roteiro",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Lacunas",
              "displayName": "Lacunas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1216,
        -448
      ],
      "id": "b1b02d6d-ad79-4fbf-83fb-07fd5c27e91b",
      "name": "Update row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getTranscript",
        "videoId": "={{ $('Loop Over Items').item.json.Link }}",
        "text": true
      },
      "type": "n8n-nodes-supadata.supadata",
      "typeVersion": 1,
      "position": [
        224,
        1096
      ],
      "id": "45771d5e-64fa-4039-8d4b-cbeccf964728",
      "name": "Get video transcript",
      "credentials": {
        "supadataApi": {
          "id": "xy8kftd2RceKVAid",
          "name": "Supadata account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1088,
        1220
      ],
      "id": "a156b55d-f0ff-4264-bf8e-bfc97451a01f",
      "name": "Get row(s) in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b010699-a676-427a-bc4c-823817b5dbb6",
              "name": "Link",
              "value": "={{ $json.Link }}",
              "type": "string"
            },
            {
              "id": "6e67b510-aac3-4129-b51c-37d7247b9acd",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -864,
        1220
      ],
      "id": "35603298-8ba1-4c1c-8cbd-4e0b8afc91ea",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -640,
        1220
      ],
      "id": "cfa614e8-95eb-4759-ab9d-c310f734f576",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -416,
        1220
      ],
      "id": "e9d3ab77-b48a-4664-a905-b17898e2c37c",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Loop Over Items').item.json.Link }}",
        "options": {
          "systemMessage": "=# üéØ Fun√ß√£o\nVoc√™ √© um **Analista de Estrutura Narrativa de V√≠deos do YouTube**.  \nSua tarefa √© **ler a transcri√ß√£o completa de um v√≠deo** e **mapear a estrutura narrativa e l√≥gica do roteiro** ‚Äî ou seja, como o conte√∫do √© organizado, dividido e comunicado.\n\n‚ö†Ô∏è **Importante:**  \n- N√ÉO gere t√≠tulo.  \n- N√ÉO fa√ßa suposi√ß√µes.  \n- Baseie-se **apenas** no conte√∫do da transcri√ß√£o.  \n- O foco √© **entender o roteiro** e como o v√≠deo se desenrola, n√£o o tema em si.\n\n---\n\n## üì• Entrada\nTranscri√ß√£o textual completa do v√≠deo (sem cortes).\n\n---\n\n## üß© Etapas de An√°lise\n\n### 1Ô∏è‚É£ Identifica√ß√£o das Se√ß√µes\n- Divida o v√≠deo em blocos/se√ß√µes coerentes.\n- Nomeie cada bloco com um **t√≠tulo descritivo**.\n- Informe o **tempo aproximado de in√≠cio** (se dispon√≠vel).\n- Descreva:\n  - **Tipo de conte√∫do:** educacional, t√©cnico, motivacional, promocional, storytelling, etc.\n  - **Fun√ß√£o:** introdu√ß√£o, explica√ß√£o, demonstra√ß√£o, exemplo, CTA (chamada para a√ß√£o), conclus√£o, etc.\n  - **Descri√ß√£o:** o que acontece e qual o prop√≥sito comunicativo da se√ß√£o.\n\n### 2Ô∏è‚É£ Extra√ß√£o de Conte√∫do\n- Liste os **t√≥picos principais** (conceitos, temas e ideias-chave).\n- Liste os **conceitos t√©cnicos** ou termos importantes mencionados.\n\n### 3Ô∏è‚É£ An√°lise de Fluxo\n- Descreva **como o v√≠deo progride**:\n  - As transi√ß√µes s√£o suaves ou abruptas?\n  - Existe um padr√£o l√≥gico (problema ‚Üí solu√ß√£o ‚Üí refor√ßo ‚Üí CTA)?\n  - O apresentador refor√ßa ideias, d√° exemplos, faz pausas estrat√©gicas?\n\n### 4Ô∏è‚É£ S√≠ntese Estrutural\n- Resuma a **mensagem central** (em uma frase).\n- Descreva:\n  - **estrat√©giaNarrativa:** estrutura geral (ex: tutorial linear, storytelling, problema-solu√ß√£o, jornada, etc.)\n  - **estiloDeEntrega:** (ex: t√©cnico, did√°tico, emocional, informal)\n  - **estruturaResumo:** vers√£o compacta do fluxo em uma linha (ex: Introdu√ß√£o > Explica√ß√£o > Aplica√ß√£o > Conclus√£o)\n\n---\n\n## üßæ Sa√≠da esperada (em JSON estrito)\n\n```json\n{\n  \"mensagemCentral\": \"string (resumo em 1 frase)\",\n  \"estrutura\": [\n    {\n      \"secao\": \"string (nome da se√ß√£o)\",\n      \"inicioAprox\": \"string (ex: '00:00')\",\n      \"tipo\": \"string (ex: educacional, t√©cnico, motivacional)\",\n      \"funcao\": \"string (ex: introdu√ß√£o, explica√ß√£o, CTA)\",\n      \"descricao\": \"string (resumo do que ocorre na se√ß√£o)\"\n    }\n  ],\n  \"t√≥picosPrincipais\": [\"string\"],\n  \"conceitosTecnicos\": [\"string\"],\n  \"analiseFluxo\": \"string (descri√ß√£o do progresso do v√≠deo e transi√ß√µes)\",\n  \"estrategiaNarrativa\": \"string (modelo estrutural adotado)\",\n  \"estiloDeEntrega\": \"string (tom geral da apresenta√ß√£o)\",\n  \"estruturaResumo\": \"string (resumo linear da estrutura)\"\n}\n‚öôÔ∏è Regras e Valida√ß√µes\nProibido gerar ‚Äútitulo‚Äù ‚Üí se o modelo criar esse campo, ignore ou remova.\n\nEvite redund√¢ncia: se duas se√ß√µes tiverem mesmo prop√≥sito, agrupe.\n\nSe a transcri√ß√£o tiver timestamps (00:00, 02:30, etc), use-os como delimitadores de se√ß√µes.\n\nSe n√£o houver timestamps, divida por l√≥gica de conte√∫do (mudan√ßa de t√≥pico ou tom).\n\nUse frases curtas e linguagem t√©cnica, sem floreios.\n\nSempre retorne um JSON v√°lido e bem formatado.\n\n‚úÖ Exemplo de Sa√≠da\njson\nCopiar c√≥digo\n{\n  \"mensagemCentral\": \"Manter pernas fortes e um estilo de vida saud√°vel com nutri√ß√£o e exerc√≠cios previne o decl√≠nio f√≠sico do envelhecimento.\",\n  \"estrutura\": [\n    {\n      \"secao\": \"Introdu√ß√£o e Contextualiza√ß√£o\",\n      \"inicioAprox\": \"00:00\",\n      \"tipo\": \"motivacional/educacional\",\n      \"funcao\": \"Apresentar o problema do enfraquecimento das pernas e gerar engajamento.\",\n      \"descricao\": \"O apresentador destaca o impacto da perda muscular e convida o p√∫blico √† a√ß√£o.\"\n    },\n    {\n      \"secao\": \"Explica√ß√£o Cient√≠fica\",\n      \"inicioAprox\": \"02:00\",\n      \"tipo\": \"t√©cnico\",\n      \"funcao\": \"Apresentar fundamentos biol√≥gicos e fisiol√≥gicos.\",\n      \"descricao\": \"Fala sobre sarcopenia e perda de densidade √≥ssea, apoiado em estudos.\"\n    },\n    {\n      \"secao\": \"Aplica√ß√£o Pr√°tica - Exerc√≠cios e Nutri√ß√£o\",\n      \"inicioAprox\": \"10:00\",\n      \"tipo\": \"instrutivo\",\n      \"funcao\": \"Ensinar como aplicar os conceitos em pr√°ticas cotidianas.\",\n      \"descricao\": \"Explica exerc√≠cios, alimenta√ß√£o e h√°bitos di√°rios para manter for√ßa muscular.\"\n    },\n    {\n      \"secao\": \"Conclus√£o e CTA\",\n      \"inicioAprox\": \"25:00\",\n      \"tipo\": \"motivacional\",\n      \"funcao\": \"Encerrar com refor√ßo e convite √† a√ß√£o.\",\n      \"descricao\": \"Refor√ßa a import√¢ncia da consist√™ncia e convida √† inscri√ß√£o e coment√°rios.\"\n    }\n  ],\n  \"t√≥picosPrincipais\": [\"sarcopenia\", \"for√ßa muscular\", \"nutri√ß√£o\", \"exerc√≠cios\", \"longevidade\"],\n  \"conceitosTecnicos\": [\"col√°geno\", \"isometria\", \"vitamina D\", \"c√°lcio\"],\n  \"analiseFluxo\": \"O v√≠deo segue de um gancho motivacional para uma explica√ß√£o t√©cnica e encerra com aplica√ß√µes pr√°ticas e CTA. As transi√ß√µes s√£o suaves e bem conectadas.\",\n  \"estrategiaNarrativa\": \"Problema ‚Üí Explica√ß√£o ‚Üí Solu√ß√£o pr√°tica ‚Üí Refor√ßo/CTA\",\n  \"estiloDeEntrega\": \"Did√°tico e t√©cnico, com tom inspirador.\",\n  \"estruturaResumo\": \"Introdu√ß√£o > Explica√ß√£o > Aplica√ß√£o > Conclus√£o\"\n}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        512,
        1096
      ],
      "id": "ffe102df-ed7c-4cd3-866f-962d866f95eb",
      "name": "AI Agent3"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        584,
        1320
      ],
      "id": "a0e9b798-6462-4c92-8b93-fcf7d0a96ff8",
      "name": "OpenAI Chat Model3",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Transcri√ß√£o": "={{ $json.output }}",
            "row_number": "={{ $('Loop Over Items').item.json.row_number }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "ID",
              "displayName": "ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Titulo ",
              "displayName": "Titulo ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Link",
              "displayName": "Link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Descri√ß√£oThumb",
              "displayName": "Descri√ß√£oThumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Transcri√ß√£o",
              "displayName": "Transcri√ß√£o",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FormatoVideo",
              "displayName": "FormatoVideo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "EngajamentoRate",
              "displayName": "EngajamentoRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "LikeRate",
              "displayName": "LikeRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CommetRate",
              "displayName": "CommetRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "totalEngagement",
              "displayName": "totalEngagement",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "totalEngagementRate",
              "displayName": "totalEngagementRate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "viewsPerDay",
              "displayName": "viewsPerDay",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "outlierScore",
              "displayName": "outlierScore",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Score Final",
              "displayName": "Score Final",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Classifica√ß√£oGeral",
              "displayName": "Classifica√ß√£oGeral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Classifica√ß√£o",
              "displayName": "Classifica√ß√£o",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Flags",
              "displayName": "Flags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1088,
        1200
      ],
      "id": "5006c915-8d15-4050-92ba-55b5b453b96f",
      "name": "Update row in sheet3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "amount": 60
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        864,
        1096
      ],
      "id": "af07d6bf-aee9-4f2d-9ca0-b046d9d939c4",
      "name": "Wait1",
      "webhookId": "5e9dedc2-9806-45a6-85d6-f15b921841ce"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "899a5be4-14a2-4d90-affb-d687bfa39d9d",
              "leftValue": "={{ $('Get row(s) in sheet3').item.json[\"Transcri√ß√£o\"] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -128,
        1096
      ],
      "id": "ee6d34a4-a3cd-42c7-a262-113f63d7e999",
      "name": "If1"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -128,
        800
      ],
      "id": "93ef7d18-96f9-4f46-b2c8-f3f4cb0b4f30",
      "name": "Aggregate4"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        224,
        800
      ],
      "id": "b842fd69-7727-464b-9e6d-18f3af9d7f63",
      "name": "Get row(s) in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "96e6f450-4dfc-4009-8a76-3887f8508386",
              "name": "Transcri√ß√£o",
              "value": "={{ $json[\"Transcri√ß√£o\"] }}",
              "type": "string"
            },
            {
              "id": "38bb6d5f-61c9-4777-9b00-3e31e919ad76",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        576,
        800
      ],
      "id": "804a3168-f1bc-48f0-ba25-f9751eec27fe",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "jsCode": "// Pega apenas os 10 primeiros itens do input\nconst limit = 50;\nreturn $input.all().slice(0, limit);\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        864,
        800
      ],
      "id": "ab18a792-be69-4485-a123-d889733dbc7d",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json[\"Transcri√ß√£o\"] }}",
        "options": {
          "systemMessage": "=<persona>\nVoc√™ √© um Analista de Padr√µes Narrativos especializado em roteiros de v√≠deos para YouTube, com foco em identificar os elementos estruturais e ret√≥ricos que geram alto ou baixo desempenho.  \nSua fun√ß√£o √© comparar as estruturas de v√≠deos bem-sucedidos (top v√≠deos) e os de baixo desempenho (bottom v√≠deos), detectando padr√µes recorrentes e anomalias de forma objetiva, baseada em dados observ√°veis.  \nVoc√™ atua como um **‚Äúcientista de estrutura narrativa‚Äù**, n√£o como roteirista criativo.\n</persona>\n\n<objetivo>\nAnalisar as estruturas de roteiro de v√≠deos fornecidas e identificar:\n- Os **padr√µes estruturais, comunicativos e ret√≥ricos** que se repetem entre os v√≠deos de melhor desempenho;\n- Os **anti-padr√µes** (erros estruturais, aus√™ncias ou excessos) observados nos v√≠deos de baixo desempenho;\n- Gerar diretrizes pr√°ticas e replic√°veis para a cria√ß√£o de roteiros mais eficazes.\n\n</objetivo>\n\n<regras_e_diretrizes>\n‚úÖ **Baseado em dados observ√°veis** ‚Äî todos os padr√µes devem vir de repeti√ß√µes reais nas estruturas analisadas (ex: ‚Äú80% dos v√≠deos de sucesso t√™m introdu√ß√µes com gancho emocional e CTA em at√© 30s‚Äù).  \n‚úÖ **Comparativo e contrastivo** ‚Äî sempre destacar diferen√ßas entre v√≠deos ‚ÄúTop‚Äù e ‚ÄúBottom‚Äù.  \n‚úÖ **Classifica√ß√£o por categoria estrutural** ‚Äî organize os padr√µes por tipo (Abertura, Desenvolvimento, Call to Action, Transi√ß√µes, Tom e Ritmo, etc.).  \n‚úÖ **Linguagem objetiva e acion√°vel** ‚Äî n√£o diga ‚Äúroteiro envolvente‚Äù, diga **por que**: (ex: ‚Äúuso de perguntas no in√≠cio aumenta a reten√ß√£o‚Äù).  \n‚úÖ **Nada de achismos** ‚Äî n√£o infira inten√ß√£o do criador, apenas o padr√£o estrutural observado.  \n‚úÖ **Formato padronizado e em JSON** ‚Äî deve seguir a estrutura abaixo.\n\n</regras_e_diretrizes>\n\n<formato_input>\nO agente receber√° um JSON com duas listas:\n\n{\n  \"top_roteiros\": [\n    { \"mensagemCentral\": \"...\", \"estrutura\": [...], \"estrategiaNarrativa\": \"...\", \"estiloDeEntrega\": \"...\", \"estruturaResumo\": \"...\" },\n    ...\n  ],\n  \"bottom_roteiros\": [\n    { \"mensagemCentral\": \"...\", \"estrutura\": [...], \"estrategiaNarrativa\": \"...\", \"estiloDeEntrega\": \"...\", \"estruturaResumo\": \"...\" },\n    ...\n  ]\n}\n</formato_input>\n\n<formato_saida>\nA resposta deve ser um JSON com a seguinte estrutura:\n\n{\n  \"padr√µes_narrativos\": {\n    \"abertura\": {\n      \"top\": [\"gancho emocional em at√© 0:30s\", \"promessa clara de transforma√ß√£o\", \"uso de pergunta provocativa\"],\n      \"bottom\": [\"introdu√ß√£o longa sem objetivo\", \"sem gancho ou conex√£o emocional\"],\n      \"diretriz\": \"Come√ßar com gancho claro e promessa de benef√≠cio dentro dos primeiros 30 segundos.\",\n      \"por_que_funciona\": \"Os v√≠deos de sucesso ret√™m aten√ß√£o inicial ao criar curiosidade imediata e alinhar expectativa.\"\n    },\n    \"desenvolvimento\": {\n      \"top\": [\"estrutura linear problema ‚Üí explica√ß√£o ‚Üí solu√ß√£o\", \"transi√ß√µes suaves entre t√≥picos\", \"uso de exemplos pr√°ticos\"],\n      \"bottom\": [\"saltos tem√°ticos\", \"aus√™ncia de estrutura clara\", \"excesso de informa√ß√£o sem contexto\"],\n      \"diretriz\": \"Manter progress√£o l√≥gica com transi√ß√µes claras e exemplos concretos.\",\n      \"por_que_funciona\": \"Mant√©m o espectador engajado e reduz frustra√ß√£o cognitiva.\"\n    },\n    \"tom_e_ritmo\": {\n      \"top\": [\"equil√≠brio entre t√©cnico e emocional\", \"uso de pausas e varia√ß√£o de energia\"],\n      \"bottom\": [\"monotonia de fala\", \"linguagem excessivamente t√©cnica\"],\n      \"diretriz\": \"Equilibrar conte√∫do t√©cnico com emo√ß√£o e ritmo de fala variado.\",\n      \"por_que_funciona\": \"Varia√ß√£o de tom aumenta reten√ß√£o e aproxima o p√∫blico.\"\n    },\n    \"transicoes\": {\n      \"top\": [\"uso de frases conectoras (ex: 'agora que voc√™ entendeu‚Ä¶')\", \"retomadas curtas de contexto\"],\n      \"bottom\": [\"mudan√ßas bruscas de tema\", \"aus√™ncia de conectores l√≥gicos\"],\n      \"diretriz\": \"Usar transi√ß√µes verbais que conectem se√ß√µes e reforcem o fluxo l√≥gico.\",\n      \"por_que_funciona\": \"Garante fluidez narrativa e compreens√£o cont√≠nua.\"\n    },\n    \"call_to_action\": {\n      \"top\": [\"CTA natural ao final com refor√ßo positivo\", \"convite √† intera√ß√£o contextualizado\"],\n      \"bottom\": [\"CTA gen√©rico ou ausente\", \"pedido de inscri√ß√£o desconectado do tema\"],\n      \"diretriz\": \"Conectar o CTA ao conte√∫do do v√≠deo de forma contextual e positiva.\",\n      \"por_que_funciona\": \"Transforma engajamento em a√ß√£o sem quebrar o fluxo emocional.\"\n    }\n  },\n  \"anti_padr√µes\": [\n    \"Evitar introdu√ß√µes longas e sem prop√≥sito\",\n    \"Evitar explica√ß√µes t√©cnicas sem contextualiza√ß√£o pr√°tica\",\n    \"Evitar mudan√ßas bruscas de assunto sem transi√ß√£o clara\",\n    \"Evitar CTAs gen√©ricos ou for√ßados\"\n  ],\n  \"insight_geral\": \"Os roteiros de sucesso seguem uma sequ√™ncia clara de gancho inicial, desenvolvimento l√≥gico e conclus√£o com CTA contextualizado. Mant√™m equil√≠brio entre t√©cnica e emo√ß√£o, com ritmo din√¢mico e transi√ß√µes suaves. Os roteiros de baixo desempenho s√£o lineares demais, frios e desorganizados, com introdu√ß√µes lentas e CTAs desconectados.\"\n}\n</formato_saida>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        1312,
        800
      ],
      "id": "b35f4e91-06a3-499a-93ef-b080c2843001",
      "name": "AI Agent4"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1384,
        1024
      ],
      "id": "57d5037e-50d3-4bed-bf33-4394ff39285d",
      "name": "OpenAI Chat Model4",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Transcri√ß√£o"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1088,
        800
      ],
      "id": "53eebed2-1f19-4f5c-a21a-2a036fa28f4e",
      "name": "Aggregate5"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1109606750,
          "mode": "list",
          "cachedResultName": "IDentifica√ß√£o de padr√µes",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=1109606750"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": 2,
            "Thumb": "=",
            "Roteiro": "={{ $json.output }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "TituloPositivo",
              "displayName": "TituloPositivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TituloNegativo",
              "displayName": "TituloNegativo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Roteiro",
              "displayName": "Roteiro",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1664,
        800
      ],
      "id": "a6b34f8f-a25e-416c-9da9-d6ad1e11876c",
      "name": "Update row in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.data }}",
        "options": {
          "systemMessage": "=<role> Voc√™ √© um **Normalizador de Oportunidades**. Seu papel √© transformar padr√µes de n-gramas detectados automaticamente em **lacunas tem√°ticas consolidadas** ‚Äî agrupadas, contextualizadas e pontuadas ‚Äî para o agente gerador de ideias. </role>\n<input> Voc√™ receber√° um objeto JSON com duas partes:\n{\n  \"resumo\": {\n    \"totalVideosBase\": number,\n    \"p75\": number,\n    \"p90\": number\n  },\n  \"padroesRarosFortes\": [\n    {\n      \"ngrama\": \"string\",\n      \"ocorrencias\": number,\n      \"presentesNosTop\": number,\n      \"outlierScoreMedio\": number,\n      \"exemplos\": [\"string\", \"string\", \"string\"]\n    }\n  ]\n}\n\n\nEsses dados v√™m do analisador de benchmark e representam padr√µes reais observados em v√≠deos de um mesmo subnicho (ex: weak legs).\nOs n-gramas podem conter combina√ß√µes de termos em ingl√™s ou portugu√™s, e j√° foram filtrados por relev√¢ncia.\n</input>\n\n<task>\n\nSua tarefa √© consolidar esses n-gramas em temas acion√°veis, extraindo o contexto e produzindo uma lista de lacunas tem√°ticas de alto potencial.\n\nEtapas:\n\nAgrupar n-gramas semelhantes:\n\nUse a semelhan√ßa sem√¢ntica ou tokens-chave para unir express√µes relacionadas.\n\nExemplo:\n\n‚Äúvitamin combo‚Äù, ‚Äúlegs vitamin‚Äù ‚Üí ‚Äúvitaminas que fortalecem pernas fracas‚Äù\n\n‚Äúclimb stairs‚Äù, ‚Äústairs easily‚Äù ‚Üí ‚Äúsubir escadas com facilidade‚Äù\n\nCalcular m√©tricas consolidadas:\n\nvideosExistentes: soma das ocorr√™ncias.\n\npercentualDaBase: (videosExistentes / totalVideosBase) √ó 100.\n\noutlierScoreMedio: m√©dia ponderada das pontua√ß√µes do grupo.\n\nconcorrencia:\n\n< 2% ‚Üí ‚Äúbaixa‚Äù\n\n2‚Äì5% ‚Üí ‚Äúmedia‚Äù\n\n5% ‚Üí ‚Äúalta‚Äù\n\nexemplos: at√© 3 t√≠tulos reais mais representativos.\n\nPontuar e ranquear:\n\nBase = 50\n\n+25 se outlierScoreMedio >= p90\n\n+15 se outlierScoreMedio >= p75\n\n+15 se percentualDaBase < 2\n\n+10 se percentualDaBase < 5\n\nScore final limitado entre 60 e 95.\n\nProduzir 10 lacunas principais:\n\nOrdenadas por scoreEstimado (descendente).\n\nUsar nomes de tema claros e compreens√≠veis.\n\nN√£o inventar termos n√£o presentes nos dados.\n\nTraduzir t√≠tulos ou termos para portugu√™s quando fizer sentido.\n\n</task>\n\n<output_format>\n\n{\n  \"nicho\": \"weak legs / idosos\",\n  \"data_analise\": \"YYYY-MM-DD\",\n  \"benchmarks\": { \"p75\": number, \"p90\": number },\n  \"baseAnalisada\": number,\n  \"lacunas\": [\n    {\n      \"ranking\": number,\n      \"tema\": \"string\",\n      \"videosExistentes\": number,\n      \"percentualDaBase\": number,\n      \"outlierScoreMedio\": number,\n      \"concorrencia\": \"baixa|media|alta\",\n      \"exemplos\": [\"string\", \"string\", \"string\"],\n      \"scoreEstimado\": number\n    }\n  ]\n}\n\n\n</output_format>\n\n<regras_criticas>\n‚úÖ Use apenas dados fornecidos ‚Äî n√£o crie informa√ß√µes externas.\n‚úÖ Mantenha nomes de tema curtos e pr√°ticos.\n‚úÖ Sempre retorne 10 lacunas no m√°ximo.\n‚úÖ Traduza termos t√©cnicos em linguagem natural (ex: ‚Äúweak shaky legs‚Äù ‚Üí ‚Äúpernas fracas e tr√™mulas‚Äù).\n‚úÖ Priorize temas que combinam alta performance (outlierScoreMedio) e baixa concorr√™ncia.\n‚ùå N√£o misture subnichos diferentes.\n‚ùå N√£o invente t√≠tulos de v√≠deo ‚Äî use apenas exemplos reais.\n</regras_criticas>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -128,
        1744
      ],
      "id": "1e613b1e-daa0-4764-ac5e-f60426f97379",
      "name": "AI Agent6"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -48,
        1968
      ],
      "id": "9a846229-85d0-4131-893a-440c17ef2769",
      "name": "OpenAI Chat Model6",
      "credentials": {
        "openAiApi": {
          "id": "CadVJxAMfFuUEGRV",
          "name": "Guilherme"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1024,
        1744
      ],
      "id": "286c191d-caa9-4db8-a230-f4cad3fea9a7",
      "name": "Get row(s) in sheet6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "38bb6d5f-61c9-4777-9b00-3e31e919ad76",
              "name": "row_number",
              "value": "={{ $json.row_number }}",
              "type": "number"
            },
            {
              "id": "96e6f450-4dfc-4009-8a76-3887f8508386",
              "name": "Titulo",
              "value": "={{ $json[\"Titulo \"] }}",
              "type": "string"
            },
            {
              "id": "d734fda8-fffb-4793-a9e2-a430c6b7ab5e",
              "name": "outlierScore",
              "value": "={{ $json.outlierScore }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -800,
        1744
      ],
      "id": "ca59cfab-b69a-4d0b-ba01-d5c456ec118c",
      "name": "Edit Fields8"
    },
    {
      "parameters": {
        "jsCode": "// ============================================================\n// PADR√ïES RAROS-FORTES (N-GRAMAS) DENTRO DA PR√ìPRIA BASE\n// Focado no subnicho \"weak legs\" (ou similar) ‚Äî evita caudas de canal\n// Input por item: { \"Titulo\" ou \"Titulo \", outlierScore, [ID|id opcional] }\n// Sa√≠da: padroesRarosFortes (n-gramas existentes, raros e fortes)\n// ============================================================\n\nconst START = Date.now();\n\n// ---------- Par√¢metros ----------\nconst CFG = {\n  NGRAMS: [2, 3],        // bigramas e trigramas\n  RARE_MIN: 2,           // ocorr√™ncias m√≠nimas para considerar padr√£o\n  RARE_MAX: 6,           // ocorr√™ncias m√°ximas (raridade)\n  REQUIRE_TOP_HIT: true, // exigir que apare√ßa pelo menos 1x nos TOPs\n  TOP_RATIO: 0.10,       // TOP = 10% da base (m√≠n. 1, m√°x. 50)\n  MIN_CHARS_TOKEN: 2,    // tamanho m√≠nimo do token\n  STOPWORDS_PT_EN: true, // ignora stopwords PT/EN\n  RETURN_LIMIT: 20       // quantos padr√µes retornar\n};\n\n// ---------- Delimitadores de sufixo (cortes de cauda) ----------\nconst SUFFIX_SEPARATORS = [\" | \", \" - \", \" ‚Äî \", \" ‚Äì \", \"|\", \" -\", \"- \", \"‚Äî\", \"‚Äì\", \"‚Ä¢\"];\n\n// ---------- √Çncoras de DOM√çNIO (pelo menos 1 deve estar no n-grama) ----------\nconst DOMAIN_ANCHORS = new Set([\n  // EN\n  \"leg\",\"legs\",\"weak\",\"shaky\",\"balance\",\"stairs\",\"climb\",\"walk\",\"walking\",\"fall\",\"falls\",\n  \"pain\",\"numb\",\"tingling\",\"knee\",\"knees\",\"hip\",\"hips\",\"ankle\",\"ankles\",\"calf\",\"hamstring\",\"glute\",\n  \"exercise\",\"exercises\",\"workout\",\"stretch\",\"stretches\",\"strengthen\",\"strength\",\"mobility\",\n  \"vitamin\",\"vitamins\",\"collagen\",\"foods\",\"food\",\"fruits\",\"veggies\",\"diet\",\n  // PT (se houver t√≠tulos em PT na base)\n  \"perna\",\"pernas\",\"fraca\",\"fracas\",\"equilibrio\",\"equil√≠brio\",\"escadas\",\"subir\",\"andar\",\"queda\",\"quedas\",\n  \"joelho\",\"joelhos\",\"quadril\",\"quadris\",\"tornozelo\",\"panturrilha\",\"alongamento\",\"exercicio\",\"exercicios\",\n  \"exerc√≠cio\",\"exerc√≠cios\",\"fortalecer\",\"for√ßa\",\"forca\",\"mobilidade\",\"vitamina\",\"vitaminas\",\"alimentos\",\"frutas\"\n]);\n\n// ---------- RU√çDO / CAUDA de canal / nomes pr√≥prios frequentes ----------\nconst NOISE_TOKENS = new Set([\n  \"love\",\"senior\",\"seniors\",\"health\",\"tips\",\"usa\",\"american\",\"americans\",\n  \"dr\",\"william\",\"li\",\"shi\",\"heng\",\"yi\",\"motivation\",\"channel\",\"best\",\"top\",\"video\",\"guide\"\n]);\n\n// ---------- Stopwords ----------\nconst STOP = new Set(CFG.STOPWORDS_PT_EN ? [\n  // PT\n  'o','a','os','as','um','uma','uns','umas','de','da','do','das','dos','para','por','com','sem','em','no','na','nos','nas',\n  'e','ou','que','como','mais','muito','muita','seu','sua','seus','suas','este','esta','esse','essa','aquele','aquela',\n  'voc√™','voce','se','√©','s√£o','foi','ser','tem','t√™m','tambem','tamb√©m','porque','pra','pro','nao','n√£o','ao','aos',\n  // EN\n  'the','a','an','and','or','but','in','on','at','to','for','of','with','by','from','as','is','was','are','be','been',\n  'have','has','had','do','does','did','will','would','should','can','could','may','might','must','this','that','these','those',\n  'i','you','he','she','it','we','they','my','your','his','her','its','our','their','what','which','who','when','where','why','how'\n] : []);\n\n// ---------- Utils ----------\nfunction norm(s){\n  return (s || \"\")\n    .toLowerCase()\n    .normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\") // remove acentos\n    .replace(/[^a-z0-9\\s\\|\\-\\‚Äî\\‚Äì]/gi,\" \")           // preserva separadores para corte\n    .replace(/\\s+/g,\" \")\n    .trim();\n}\n\n// corta sufixos de canal/autor ap√≥s separadores (fica s√≥ o ‚Äúmiolo do t√≠tulo‚Äù)\nfunction stripSuffixes(titleNorm){\n  let t = titleNorm;\n  for (const sep of SUFFIX_SEPARATORS){\n    const idx = t.indexOf(sep);\n    if (idx > -1) {\n      t = t.substring(0, idx).trim();\n      break; // corta no primeiro separador encontrado\n    }\n  }\n  return t;\n}\n\nfunction tokenize(rawTitle){\n  const n = norm(rawTitle);\n  const core = stripSuffixes(n);\n  const t = core.split(\" \").filter(w => w && w.length > CFG.MIN_CHARS_TOKEN && !STOP.has(w));\n  return t;\n}\n\nfunction extractNgrams(tokens, n){\n  const out = [];\n  for (let i=0;i<=tokens.length-n;i++){\n    out.push(tokens.slice(i,i+n).join(\" \"));\n  }\n  return out;\n}\nfunction mean(a){ return a.length ? a.reduce((x,y)=>x+y,0)/a.length : 0; }\nfunction percentile(arr, p){\n  if (!arr.length) return 0;\n  const a = [...arr].sort((x,y)=>x-y);\n  const idx = Math.ceil((p/100)*a.length) - 1;\n  return Number((a[Math.max(0, Math.min(idx, a.length-1))] || 0).toFixed(2));\n}\n\n// helpers dom√≠nio/ru√≠do\nfunction hasAnchor(ng){\n  return ng.split(\" \").some(tok => DOMAIN_ANCHORS.has(tok));\n}\nfunction hasNoise(ng){\n  return ng.split(\" \").some(tok => NOISE_TOKENS.has(tok));\n}\n\n// ---------- Carregar base ----------\nconst items = $input.all();\nconst base = items.map((it, idx) => {\n  const j = it.json || {};\n  const tituloRaw = j[\"Titulo \"] ?? j[\"Titulo\"] ?? j[\"titulo\"] ?? j[\"title\"] ?? \"\";\n  const titulo = (tituloRaw || \"\").toString().trim();\n  const outlierScore = Number(j.outlierScore ?? j[\"Pontua√ß√£o at√≠pica\"] ?? 0) || 0;\n  const id = j.ID ?? j.id ?? `v_${idx}`;\n  const tokens = tokenize(titulo);\n  return { id, titulo, tokens, outlierScore };\n}).filter(v => v.titulo && !isNaN(v.outlierScore));\n\nconst total = base.length;\nif (!total) return [{ json: { resumo: { totalVideosBase: 0 }, padroesRarosFortes: [] } }];\n\n// ---------- Benchmarks (da pr√≥pria base) ----------\nconst outliers = base.map(v => v.outlierScore);\nconst p50 = percentile(outliers,50);\nconst p75 = percentile(outliers,75);\nconst p90 = percentile(outliers,90);\n\n// ---------- Top K ----------\nbase.sort((a,b)=>b.outlierScore - a.outlierScore);\nconst topK = Math.max(1, Math.min(Math.round(total*CFG.TOP_RATIO), 50));\nconst topIds = new Set(base.slice(0, topK).map(v => v.id));\n\n// ---------- Mapear n-gramas EXATOS do n√∫cleo do t√≠tulo ----------\nconst maps = {}; // {2: Map, 3: Map}\nfor (const n of CFG.NGRAMS) maps[n] = new Map();\n\nfor (const v of base){\n  for (const n of CFG.NGRAMS){\n    const grams = extractNgrams(v.tokens, n);\n    grams.forEach(g => {\n      // filtros de dom√≠nio / ru√≠do j√° na coleta\n      if (!hasAnchor(g) || hasNoise(g)) return;\n\n      let m = maps[n].get(g);\n      if (!m) {\n        m = { n, key: g, count: 0, countTop: 0, outliers: [], titles: new Set(), ids: new Set() };\n        maps[n].set(g, m);\n      }\n      m.count++;\n      m.outliers.push(v.outlierScore);\n      m.titles.add(v.titulo);\n      m.ids.add(v.id);\n      if (topIds.has(v.id)) m.countTop++;\n    });\n  }\n}\n\n// ---------- Sele√ß√£o: padr√µes raros + presentes nos TOPs + fortes (‚â• p75) ----------\nfunction pickRareStrong(list){\n  const out = [];\n  for (const m of list.values()){\n    if (m.count < CFG.RARE_MIN || m.count > CFG.RARE_MAX) continue;\n    if (CFG.REQUIRE_TOP_HIT && m.countTop < 1) continue;\n\n    const outMed = Number(mean(m.outliers).toFixed(2));\n    const banda = outMed >= p90 ? \"p90+\" : (outMed >= p75 ? \"p75+\" : \"subp75\");\n    if (banda === \"subp75\") continue; // mant√©m s√≥ p75+\n\n    out.push({\n      n: m.n,\n      ngrama: m.key,                 // forma EXATA (normalizada) extra√≠da do ‚Äúmiolo‚Äù do t√≠tulo\n      count: m.count,\n      countTop: m.countTop,\n      outlierMedio: outMed,\n      exemplos: Array.from(m.titles).slice(0,3), // t√≠tulos reais\n      exemploIds: Array.from(m.ids).slice(0,3),\n      banda\n    });\n  }\n  // rank: for√ßa > outlier m√©dio > raridade (menor count) > presen√ßa nos tops\n  out.sort((a,b) => (\n    (b.banda === \"p90+\") - (a.banda === \"p90+\") ||\n    b.outlierMedio - a.outlierMedio ||\n    a.count - b.count ||\n    b.countTop - a.countTop\n  ));\n  return out;\n}\n\n// juntar bigramas e trigramas num √∫nico pool\nlet candidatos = [];\nfor (const n of CFG.NGRAMS) candidatos = candidatos.concat(pickRareStrong(maps[n]));\n\n// Garantia: s√≥ com exemplos reais\ncandidatos = candidatos.filter(c => c.exemplos && c.exemplos.length > 0);\n\n// ---------- Score de oportunidade (raridade + for√ßa + presen√ßa nos TOPs) ----------\nfunction scoreOportunidade(c){\n  const rare = Math.max(0, CFG.RARE_MAX - (c.count - CFG.RARE_MIN));                 // quanto mais raro no range, melhor\n  const rareNorm = rare / (CFG.RARE_MAX - CFG.RARE_MIN + 1);                          // 0..1\n  const strength = (c.outlierMedio >= p90) ? 1.0 : ((c.outlierMedio >= p75) ? 0.7 : 0.0); // for√ßa por banda\n  const topBoost = Math.min(1, c.countTop / Math.max(1, Math.min(c.count, 3)));       // favorece quando aparece nos tops\n  // base 50 + (0..25 raridade) + (0..20 for√ßa) + (0..10 topBoost)\n  const s = 50 + (25*rareNorm) + (20*strength) + (10*topBoost);\n  return Math.round(Math.max(60, Math.min(95, s)));\n}\n\nconst padroesRarosFortes = candidatos\n  .slice(0, CFG.RETURN_LIMIT)\n  .map((c, i) => ({\n    ranking: i+1,\n    n: c.n,\n    ngrama: c.ngrama,\n    ocorrencias: c.count,\n    presentesNosTop: c.countTop,\n    outlierScoreMedio: c.outlierMedio,\n    banda: c.banda,                 // \"p90+\" ou \"p75+\"\n    exemplos: c.exemplos,           // t√≠tulos reais\n    scoreEstimado: scoreOportunidade(c)\n  }));\n\n// ---------- Sa√≠da ----------\nconst out = {\n  resumo: {\n    totalVideosBase: total,\n    topConsiderados: topK,\n    p50, p75, p90,\n    criterios: {\n      ngrams: CFG.NGRAMS,\n      raridade: { min: CFG.RARE_MIN, max: CFG.RARE_MAX },\n      exigeTop: CFG.REQUIRE_TOP_HIT,\n      filtroForca: \">= p75\",\n      corteSufixo: SUFFIX_SEPARATORS\n    }\n  },\n  padroesRarosFortes\n};\n\nconst ELAPSED = ((Date.now()-START)/1000).toFixed(2);\nconsole.log(`‚úÖ Padr√µes raros-fortes gerados em ${ELAPSED}s | base=${total} | top=${topK}`);\npadroesRarosFortes.slice(0,5).forEach(p => console.log(`   ‚Ä¢ ${p.ngrama} | n=${p.n} | occ=${p.ocorrencias} | top=${p.presentesNosTop} | outMed=${p.outlierScoreMedio} | score=${p.scoreEstimado}`));\n\nreturn [{ json: out }];\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -576,
        1744
      ],
      "id": "bb5ad1ee-c3a4-4c1f-a798-3131ad060621",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -352,
        1744
      ],
      "id": "f4bf06e1-86b5-4b7b-87e1-cc18fb17b700",
      "name": "Aggregate7"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1109606750,
          "mode": "list",
          "cachedResultName": "IDentifica√ß√£o de padr√µes",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=1109606750"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Lacunas": "={{ $json.output }}",
            "row_number": 2
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "TituloPositivo",
              "displayName": "TituloPositivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TituloNegativo",
              "displayName": "TituloNegativo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Thumb",
              "displayName": "Thumb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Roteiro",
              "displayName": "Roteiro",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Lacunas",
              "displayName": "Lacunas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        288,
        1744
      ],
      "id": "2422b875-d5ee-4629-a040-72039308e292",
      "name": "Update row in sheet5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "KrBqg4twP2wKcI6z",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ",
          "mode": "list",
          "cachedResultName": "Teste Dev IA Pleno",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 304295346,
          "mode": "list",
          "cachedResultName": "Dados ordenados ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XlZTABwHA456bYCFRiS8BFLxynypmo65pXeBeRV1WkQ/edit#gid=304295346"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        -1536,
        904
      ],
      "id": "e0958ab7-32ce-4d7e-9043-d1b80133edbf",
      "name": "Google Sheets Trigger",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "6Z6MEbvijNLMdskV",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {}
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -1312,
        904
      ],
      "id": "a5132134-8e55-4444-a520-cd27207c7465",
      "name": "Aggregate6"
    },
    {
      "parameters": {
        "content": "## Identifica√ß√£o de Padr√µes de Performance de T√≠tulos",
        "height": 992,
        "width": 2976
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1136,
        -880
      ],
      "typeVersion": 1,
      "id": "e7159a79-740c-4c8b-8928-a51f75385025",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## An√°lise de Miniaturas & Padr√µes Visuais",
        "height": 608,
        "width": 2976,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1136,
        112
      ],
      "typeVersion": 1,
      "id": "b4f82154-8595-46e4-82e6-119e5efd28dc",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "##  An√°lise de Estrutura e Gatilhos dos Roteiros",
        "height": 752,
        "width": 2976,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1136,
        720
      ],
      "typeVersion": 1,
      "id": "3a50d704-6895-4908-8416-2af2e4aa64cb",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "##  Normaliza√ß√£o de Oportunidades (n-gramas ‚Üí lacunas tem√°ticas)",
        "height": 752,
        "width": 2976,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1136,
        1472
      ],
      "typeVersion": 1,
      "id": "4fe669ad-b9d0-4c07-98e2-a6086200d4f4",
      "name": "Sticky Note3"
    }
  ],
  "pinData": {
    "AI Agent2": [
      {
        "json": {
          "output": "{\n  \"padr√µes_visuais\": {\n    \"cores\": {\n      \"top\": [\n        \"uso frequente de fundos escuros (preto, gradientes escuros)\",\n        \"texto em cores vibrantes e contrastantes (amarelo, vermelho, branco)\",\n        \"combina√ß√£o frequente de vermelho e amarelo para √™nfase\",\n        \"uso pontual de verdes para destacarem alimentos\",\n        \"presen√ßa consistente de alto contraste texto/fundo\"\n      ],\n      \"bottom\": [\n        \"fundos com menos destaque ou gradientes simples por√©m menos contraste\",\n        \"uso de cores menos saturadas ou combina√ß√£o que n√£o destaca texto claramente\",\n        \"cores frias menos vibrantes predominando\",\n        \"menos uso de cores quentes para √™nfase\"\n      ],\n      \"diretriz\": \"Utilizar fundos escuros ou com gradientes ricos que amplifiquem o contraste com o texto em cores quentes e vibrantes (vermelho, amarelo, branco) para garantir legibilidade e destaque r√°pido.\",\n      \"por_que_funciona\": \"O alto contraste com cores vivas cuida da leitura r√°pida e atrai foco imediato no feed, onde a competi√ß√£o visual √© intensa.\"\n    },\n    \"composicao\": {\n      \"top\": [\n        \"layout assim√©trico com texto grande √† esquerda e sujeito √† direita\",\n        \"close-up ou plano m√©dio focalizando uma pessoa com express√£o clara\",\n        \"uso de elementos de destaque como setas vermelhas direcionando aten√ß√£o\",\n        \"separa√ß√£o clara entre texto e imagem para facilitar varredura visual\",\n        \"uso de layouts divididos para destacar alimento ou objetos relevantes\",\n        \"foco visual em 1-2 elementos principais equilibrados\"\n      ],\n      \"bottom\": [\n        \"composi√ß√µes mais confusas ou com muitos elementos\",\n        \"aus√™ncia de foco claro, v√°rios objetos disputando aten√ß√£o\",\n        \"elementos com enquadramento distante ou disperso\",\n        \"texto pequeno, disperso ou em m√∫ltiplas partes sem hierarquia clara\"\n      ],\n      \"diretriz\": \"Optar por composi√ß√£o simples e clara, geralmente com texto √† esquerda e sujeito ou objeto principal √† direita, usando close-ups/plano m√©dio para destacar as express√µes faciais e manter o foco no aspecto humano ou no produto.\",\n      \"por_que_funciona\": \"Simplicidade e foco facilitam a compreens√£o instant√¢nea da mensagem mesmo em tamanhos pequenos da thumbnail.\"\n    },\n    \"texto\": {\n      \"top\": [\n        \"texto curto, direto e impactante em poucas palavras (2‚Äì6 palavras-chave)\",\n        \"uso de fontes grandes, negrito e mai√∫sculas para facilitar leitura\",\n        \"texto colorido em combina√ß√£o contrastante (ex: amarelo/vermelho/branco)\",\n        \"frases segmentadas com destaques (caixas coloridas, faixas) para segmentar leitura\",\n        \"uso moderado de m√∫ltiplas cores no texto para hierarquia visual clara\",\n        \"alguns casos com chamadas urgentes (ex: 'EAT THIS NOW!')\"\n      ],\n      \"bottom\": [\n        \"textos muito longos ou com m√∫ltiplas linhas confusas\",\n        \"fontes finas, pequenas ou sem hierarquia visual clara\",\n        \"uso excessivo de cores sem contraste ou combina√ß√£o confusa\",\n        \"textos mal distribu√≠dos dificultando leitura r√°pida\"\n      ],\n      \"diretriz\": \"Manter o texto curto e em palavras-chave impactantes com fontes grandes e cores de alto contraste para permitir leitura r√°pida e compreens√£o imediata.\",\n      \"por_que_funciona\": \"Textos claros e objetivos s√£o assimilados rapidamente ao navegar, aumentando o engajamento em dispositivos m√≥veis.\"\n    },\n    \"elementos_destaque\": {\n      \"top\": [\n        \"setas vermelhas ou de cor vibrante usadas para apontar √°reas ou objetos relevantes\",\n        \"caixas coloridas ou faixas para destacar palavras ou frases-chave\",\n        \"c√≠rculos amarelos ou coloridos para foco em partes espec√≠ficas da imagem\",\n        \"uso de pequenos √≠cones ou s√≠mbolos (ex: check verde) para validar informa√ß√£o\",\n        \"cores vibrantes e elementos gr√°ficos para guiar o olhar\"\n      ],\n      \"bottom\": [\n        \"raramente elementos diretores claros\",\n        \"aus√™ncia de elementos visuais que guiam o foco\",\n        \"eventuais elementos gen√©ricos sem impacto visual (ex: m√∫ltiplos objetos dispersos)\"\n      ],\n      \"diretriz\": \"Integrar um √∫nico elemento de direcionamento visual forte, como seta vermelha ou c√≠rculo, para guiar o olhar do espectador √† informa√ß√£o-chave ou produto.\",\n      \"por_que_funciona\": \"Guiar visualmente o espectador reduz a dispers√£o e aumenta a probabilidade de clique por foco imediato.\"\n    },\n    \"express√µes_ou_sujeitos\": {\n      \"top\": [\n        \"presen√ßa marcante de pessoas (geralmente adultos ou idosos) em close-up ou plano m√©dio\",\n        \"express√µes faciais neutras a levemente sorridentes, que transmitem confian√ßa e seriedade\",\n        \"posi√ß√µes com gestos apontando para texto ou objetos\",\n        \"uso frequente de profissionais de sa√∫de com jalecos para autoridade\",\n        \"raramente express√µes neutras sem emo√ß√£o clara, por√©m sempre com olhar direto ou aten√ß√£o ao espectador\"\n      ],\n      \"bottom\": [\n        \"presen√ßa reduzida ou aus√™ncia de sujeitos humanos\",\n        \"express√µes faciais pouco definidas, ou sujeitos distantes/pequenos\",\n        \"express√µes pouco envolventes ou aus√™ncia de conex√£o visual com espectador\"\n      ],\n      \"diretriz\": \"Incluir pessoas com express√µes faciais direcionadas e levemente emotivas (confian√ßa ou leve positividade), enfatizando conex√£o visual com o espectador para aumentar a empatia.\",\n      \"por_que_funciona\": \"Face humana com express√£o sutil estimula conex√£o emocional r√°pida, aumentando chance de engajamento.\"\n    }\n  },\n  \"anti_padr√µes\": [\n    \"Evitar fundos que n√£o suportam alto contraste ou usam cores frias pouco destacadas\",\n    \"N√£o sobrecarregar a thumbnail com m√∫ltiplos elementos ou textos longos e complexos\",\n    \"Evitar fontes pequenas, finas ou pouco leg√≠veis em miniaturas\",\n    \"N√£o usar composi√ß√µes dispersas que dificultam foco visual instant√¢neo\",\n    \"Evitar aus√™ncia de elementos visuais direcionadores (setas, c√≠rculos)\",\n    \"Evitar express√µes faciais neutras e distantes sem conex√£o visual clara\"\n  ],\n  \"insight_geral\": \"Thumbnails de alto desempenho s√£o altamente contrastadas, combinam fundos escuros com textos vibrantes em vermelho, amarelo e branco, apresentam composi√ß√µes simples com foco assym√©trico em texto √† esquerda e sujeito √† direita, usam express√µes faciais humanas claras e envolventes, e incluem elementos de destaque visuais que guiam o olhar (setas, c√≠rculos). Em contraponto, thumbnails de baixo desempenho apresentam composi√ß√µes confusas, texto longo ou mal distribu√≠do, aus√™ncia de elementos diretores, fundos com pouca varia√ß√£o ou baixo contraste e falta de conex√£o emocional visual.\"\n}"
        }
      }
    ]
  },
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Sort",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [
          {
            "node": "Aggregate2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Analyze image",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate2": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet2": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Update row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet2": {
      "main": [
        []
      ]
    },
    "Update row in sheet1": {
      "main": [
        []
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Aggregate4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get video transcript": {
      "main": [
        [
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet3": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Update row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Get video transcript",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate4": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "Aggregate5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate5": {
      "main": [
        [
          {
            "node": "AI Agent4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields6": {
      "main": [
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent4": {
      "main": [
        [
          {
            "node": "Update row in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent6",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet6": {
      "main": [
        [
          {
            "node": "Edit Fields8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields8": {
      "main": [
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Aggregate7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate7": {
      "main": [
        [
          {
            "node": "AI Agent6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent6": {
      "main": [
        [
          {
            "node": "Update row in sheet5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets Trigger": {
      "main": [
        [
          {
            "node": "Aggregate6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate6": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get row(s) in sheet3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get row(s) in sheet6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "dfe8b4f2-a72b-469b-bf13-d73501668665",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c5d6c53e60bd1d3aa2e715f321339a9825e6c2e5b18beaf3f0749145af2adffd"
  },
  "id": "LtsmxxIjJpcaluiQ",
  "tags": []
}